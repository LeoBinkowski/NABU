C
C
C
	SUBROUTINE	GTUCHR(CHAR)
C
C	GET AN UPPER CASE A-Z
C
	IMPLICIT INTEGER (A-Z)
3000	CALL GTCHAR(CHAR1)
	CHAR1=CHAR1 .AND. 95
C
	IF (CHAR1 .LT. 65) GOTO 3000
	IF (CHAR1 .GT. 90) GOTO 3000
	CHAR=CHAR1
	RETURN
C
	END
C
C
C
	SUBROUTINE GTCHAR(CHAR)
C
C
C	GET A CHARACTER RETURN IN C
C	UP THE RANDOM NUMBERS
C
	IMPLICIT INTEGER (A-Z)
C
C
C
	COMMON	/ALPHA/ W1(20),W2(20),DF(2),RN(2),PY,E1,E2,
     $		F1,F2,L1,L2,WD
C
C CLEAR INPUT BUFFER
C
3500	CALL KYBD(CHAR1)
	IF(CHAR1.NE.0) GOTO 3500
C
C
4000	CALL KYBD(CHAR1)
	IF (CHAR1 .EQ. 0) GOTO 4200
C
C	TRAP ESCAPE HERE
	IF (CHAR1 .EQ. 189) CALL RSTENT
	IF (CHAR1 .EQ. 171) CALL RSTENT
	IF (CHAR1 .EQ. 234) CALL HLPENT
	IF (CHAR1 .GT. 122) GOTO 4000
	CHAR=(CHAR1 .AND. 127)
	RETURN
C
4200	RN(PY)=RN(PY)+1 .AND. 255
	IF (RN(PY) .EQ. 0) RN(PY)=1
	GOTO 4000
C
C
	END
C
C
	SUBROUTINE	BLNK1
C
C
C	BLANK PL1 MSG
	CALL	PRTAT(738,'	       ',12)
	RETURN
C
	END
C
C
	SUBROUTINE	BLNK2
C
C	BLANK PL2 MSG
	CALL	PRTAT(754,'	       ',12)
	RETURN
C
	END
C
C
C
C
C  10000   '
C
C
C	MAIN PROGRAM
C
C
	IMPLICIT INTEGER (A-Z)
C
C
	DIMENSION  LV(26),G1(20),G2(20)
C
	COMMON	/ALPHA/ W1(20),W2(20),DF(2),RN(2),PY,E1,E2,
     $		F1,F2,L1,L2,WD
C
C	SET UP LETTER VALUE ARRAY
	DATA LV / 1,2,2,2,1,2,2,2,1,4,3,1,2,
     $		  1,1,2,4,1,1,1,1,2,3,4,3,4/
	DATA RN /5,15/
C
C	WG NUMBER OF WORDS IN A GAME
	DATA WG /7/
C
C	SET UP SCREEN

C	SETUP THE REGISTERS
	CALL INIT
C	DRAW THE SCREEN
C	ONE TIME INITIALIZATION
	CALL CLRSCN
	CALL CENLIN
	CALL PRTAT( 8,'&',1)
	CALL PRTAT(22,'&',1)
	CALL PRTAT(40,'&',1)
	CALL PRTAT(54,'&',1)
	CALL PRTAT(72,'&',1)
	CALL PRTAT(86,'&',1)
C	 UNDERLINE
12350	CALL PRTAT (96,'%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%',32)
C	RIGHT HAND BOTTOM CORNER SYMBOL
	CALL PRTAT(104,'#',1)
	CALL PRTAT(118,'#',1)
C
C
C	  DRAW BOMB
	CALL DRWBOM
C	 DRAW TNT
	CALL DRWDYN
C	DRAW SCORE
	CALL PRTAT (2,'TOTAL',5)
	CALL PRTAT (69,'0',1)
	CALL PRTAT(44,'ROUND 1',7)
	CALL PRTAT (25,'TOTAL',5)
	CALL PRTAT (92,'0',1)
C
C
C	  PLAY HANGMAN
C
C
C
C
C	  SET UP DIFICULTY LEVEL
C
11000	CALL PRTAT (642,'	     ',12)
	CALL PRTAT (658,'	     ',12)
	CALL PRTAT (738,'LEVEL 1-3?',10)
	PY=1
C	GET A CHAR
11140	CALL GTCHAR(CHAR)
	IF (CHAR .LT. 49) GOTO 11140
	IF (CHAR .GT. 51) GOTO 11140
	DF(1)=CHAR-47
	CALL BLNK1
C	 GET PLAYER 2 DIFICULTY
	CALL PRTAT (754,'LEVEL 1-3?',10)
	PY=2
11260	CALL GTCHAR(C)
	IF ((C .LT. 49) .OR. (C .GT. 51)) GOTO 11260
	DF(2)=C-47
	CALL BLNK2
C	  SEE WHO STARTS
11410	WH=(RN(1)+RN(2)) .AND. 1
	IF (WH .EQ. 0) WH=2
	T1=0
	T2=0
	S1=0
	S2=0
	CALL PRTAT (67,'  0  ',5)
	CALL PRTAT (90,'  0  ',5)
C
C	  SET UP TO PLAY A ROUND
C
C	SET WORD COUNT BACK
	WD=0
C
C	PLAY A GAME
C
C	now inline code
C	GOSUB 13000
C	GOTO 11000
C
C
C
13000	CONTINUE
C	 SET GUESSUS TO "-"
	CALL DRWBOM
	CALL DRWDYN
	DO 13080 I=1,20
	    G1(I)=45
	    G2(I)=45
	    W1(I)=0
	    W2(I)=0
13080	CONTINUE
C
C	 GET NEW WORD FOR PLAYER 1
13100	PY=1
	CALL GENWD(W1,L1)
C	CALCULATE THE POSITION TO CENTER THE WORD!!!
	E1=642+6-(L1/2)
C
C	 GET NEW WORD FOR PLAYER 2
	PY=2
	CALL GENWD(W2,L2)
C	CALCULATE THE POSITION TO CENTER THE WORD!!!
	E2=658+6-(L2/2)
	C1=0
	C2=0
C	SET FLAG FOR FUSE POINTS AVAILABLE
	FP=1
C	 NO RIGHT IN A ROW
	R1=0
	R2=0
C	PLAYER NOT BLOWN UP
	P1=0
	P2=0
C	 RESET FUSES
	F1=0
	F2=0
C	KNOWN LENGTH OF WORD
	K1=0
	K2=0
	IF (DF(1) .NE. 3) K1=L1
	IF (DF(2) .NE. 3) K2=L2
C	PRINT THE ROUND NUMBER
	ITEMP=WD+1
	CALL PRTNUM(49,ITEMP,2)
C	 BLANK OLD WORDS
C
	CALL PRTAT (642,'	     ',12)
	CALL PRTAT (658,'	     ',12)
C
C	  DISPLAY THE WORDS
C

C	POSITION FOR PLAYER 1 WORD
	P=E1
	IF (K1 .EQ.0) GOTO 13590
	DO 13590 I=1,K1
	    CS=G1(I)
	    CALL PRTCHR (P,CS)
13590	CONTINUE
C
C	POSITION FOR PLAYER 2 WORD
	P=E2
	IF (K2 .EQ.0) GOTO 13650
	DO 13650 I=1,K2
	    CS=G2(I)
	    CALL PRTCHR (P,CS)
13650	CONTINUE
C
C
C	  GO DO A WORD
C
C
C	 SEE WHO STARTS
	IF (WH .EQ. 1) GOTO 14000
C
	GOTO 15000
C
C	AFTER PLAYING A ROUND RETURN HERE
13700	CONTINUE
C	 SEE IF HAD 7 WORDS FOR A ROUND
	WD=WD+1
	IF (WD .LT. WG) GOTO 13000
C	 PLAYED 7 WORDS
C	  PLAY AGAIN?
	CALL PRTAT (610,'SAME OPTIONS?   PRESS GO     ',29)
	CALL PRTAT (642,'                             ',29)
	CALL PRTAT (674,'NEW OPTIONS?    PRESS RESTART',29)
	CALL PRTAT (706,'                             ',29)
	CALL PRTAT (738,'NEW CHOICE?     PRESS EXIT   ',29)
  500	CALL GTCHAR (C)
	IF (C .NE. 13) GOTO 500
	WD = 0
	CALL PRTAT (610,'                             ',29)
	CALL PRTAT (674,'                             ',29)
	CALL PRTAT (738,'                             ',29)
	CALL CENLIN
	GOTO 11410
C
C
C
C		  PLAYER ONES TURN
C
14000	PY=1
	IF (P2 .EQ. 0) CALL PRTAT(738,'YOUR GUESS',10)
	IF (P2 .EQ. 1) CALL PRTAT(738,'GUESS/STOP*',11)
C
14030	CALL GTCHAR(C)
	IF (P2 .EQ. 0) GOTO 14065
	IF (C .NE. 42) GOTO 14065
C	 WANTS TO STOP
	T1=T1+S1
	CALL BLNK1
C	 DISPLAY THE WORD
	CALL BLOONE(1)
	GOTO 14680
C
C	  NORMAL BET?
C
14065	CONTINUE
	IF (C .NE. 63) GOTO 14200
	CALL BLNK1
	CALL PRTAT(738,'GUESS WORD',10)
	BP=S1

	DO 14140 I1=1,L1
	IF (G1(I1) .NE. 45) GOTO 14140
	CALL GTUCHR(C)
	IF (C .NE. W1(I1)) GOTO 14160
	CALL SNDGLR
	S1=S1+LV(C-64)
	P=E1-1+I1
	CS=C
	CALL PRTCHR (P,CS)
14140	CONTINUE
	CALL BLNK1
	S1=S1+BP
	GOTO 14640
C
C	  BAD BET
14160	CALL BLNK1
	CALL PRTAT(642,'	    ',12)
	S1=0
	R1=0
	IF (K1 .EQ.0) GOTO 14180
	DO 14180 I1=1,K1
	P=E1-1+I1
	CS=G1(I1)
	CALL PRTCHR (P,CS)
14180	CONTINUE
	GOTO 14440
C
C	  VALID LETTER?
C
14200	C=C .AND. 95
	IF (C .LT. 65) GOTO 14030
	IF (C .GT. 90) GOTO 14030
C
C	  VALID LETTER
	WH=2
	CALL BLNK1
C	  IF D3 ONLY SHOW KNOWN LETTERS
	IF (DF(1) .NE. 3) GOTO 14300
	DO 14275 I1=1,L1
	IF (C .NE. W1(I1)) GOTO 14275
	IF (I1 .GT. K1) K1=I1
14275	CONTINUE
C
C	 FLAG FOR A GOOD GUESS
14300	OK=0
C	 TEST FOR CHARACTER MATCH
	IF (K1 .EQ.0) GOTO 14410
	DO 14410 I1= 1,K1
	P=E1-1+I1
C   CROSS HATCH SHOULD BE +
	CS=43
	CALL PRTCHR (P,CS)
C	 SEE IF (HE GUESSED RIGHT
	IF (C .NE. W1(I1)) GOTO 14370
	OK=1
	IF (C .EQ. G1(I1)) OK=2
C	   HE ALREADY GOT IT
	IF (C .EQ. G1(I1)) GOTO 14370
	S1=S1+LV(C-64)
	CALL SNDGLR
	G1(I1)=C
14370	CALL WAITFT(140)
C	 PUT BACK CHARACTER
	P=E1-1+I1
	CS=G1(I1)
	CALL PRTCHR (P,CS)
14410	CONTINUE
	IF (OK .EQ. 0) GOTO 14440
	IF (OK .EQ. 2) GOTO 14430
C	 UP GUESS IN A ROW
	R1=R1+1
14430	GOTO 14600
C
C	  BURN FUSE
14440	F1=F1+1
	R1=0
	LEFT=1
	CALL BURNFS(LEFT)
C
14540	IF (F1 .LT. 8) GOTO 15000
C
C	   THE BANG
C	 DONT UP OUR SCORE
14550	P1=1
	CALL BLOONE(0)
	S1=0
	GOTO 14680
C      SEE IF HES GOT ALL THE LETTERS
14600	DO 14615 I=1,L1
	    IF (G1(I) .EQ. 45) GOTO 15000
14615	CONTINUE
C
C	  HE GOT THE WORD
14640	T1=T1+S1
	IF (FP .EQ. 0) GOTO 14680
	FP=0
C	 AWARD HIM FUSE POINTS
	T1=T1+(8-F1)*2
C	FINISHED
14680	C1=1
	S1=0
	CALL PRTNUM(67,T1,3)
C
C	 IF YOU BLEW UP LET HIM GO
14760	IF (P1 .EQ. 1) GOTO 16000
C	 PSEUDO RETURN GOTO 13700
14765	IF (P2 .EQ. 1) GOTO 13700
C	YOU GOT WORD SO BLOW HIM UP
	CALL BLOTWO(0)
C	 PSEUDO RETURN GOTO 13700
	GOTO 13700
C
C	  PLAYER TWO'S TURN
C
C
15000	PY=2
	IF (C2 .EQ. 1) GOTO 16000
C
C	 PRINT YOUR GUESS
	IF (P1 .EQ. 0) CALL PRTAT(754,'YOUR GUESS',10)
	IF (P1 .EQ. 1) CALL PRTAT(754,'GUESS/STOP*',11)
C
C	 GET A CHARACTER
15110	CALL GTCHAR(C)
C	'TEST FOR STOP
	IF (P1 .EQ. 0) GOTO 43100
	IF (C .NE. 42) GOTO 43100
C	'WANTS TO STOP
	T2=T2+S2
	CALL BLNK2
C	DISPLAY THE WORD
	CALL BLOTWO(1)
	GOTO 15700
C
C	 NORMAL BET
43100	IF (C .NE. 63) GOTO 43400
	CALL BLNK2
	CALL PRTAT(754,'GUESS WORD',10)
	BP=S2
	WH=1
	DO 43155 I2=1,L2
	IF (G2(I2) .NE. 45) GOTO 43155
	CALL GTUCHR(C)
	IF (C .NE. W2(I2)) GOTO 43180
	CALL SNDGLR
	S2=S2+LV(C-64)
	P=E2-1+I2
	CS=C
	CALL PRTCHR (P,CS)
43155	CONTINUE
	CALL BLNK2
	S2=S2+BP
	GOTO 15660
C
C	 BAD BET
43180	CALL BLNK2
	CALL PRTAT(658,'	    ',12)
	S2=0
	R2=0
	IF (K2 .EQ.0) GOTO 43200
	DO 43200 I2=1,K2
	P=E2-1+I2
	CS=G2(I2)
	CALL PRTCHR (P,CS)
43200	CONTINUE
	GOTO 15390
43400	C=C .AND. 95
	IF (C .LT. 65) GOTO 15110
	IF (C .GT. 95) GOTO 15110
C	
C	'VALID LETTER
	WH=1
	CALL BLNK2
	IF (DF(2) .NE. 3) GOTO 15150
	DO 15148 I2= 1,L2
	IF (C .NE. W2(I2)) GOTO 15148
	IF (I2 .GT. K2) K2=I2
15148 CONTINUE
C	 FLAG FOR A GOOD MATCH
15150	OK=0
C	 TEST FOR A CHARACTER MATCH
	IF (K2 .EQ.0) GOTO 15340
	DO 15340 I2=1,K2
	P=E2-1+I2
C	 SOLID CURSOR CHAR
	CS=43
	CALL PRTCHR (P,CS)
C	 SEE IF (HE GUESSED RIGHT
	IF (C .NE. W2(I2)) GOTO 15300
	OK =1
	IF (C .EQ. G2(I2)) OK=2
C	 HE ALREADY GOT IT
	IF (C .EQ. G2(I2)) GOTO 15300
	S2=S2+LV(C-64)
	CALL SNDGLR
	G2(I2)=C
C
15300	CALL WAITFT(140)
C	 PUT BACK CHARACTER
	P=E2-1+I2
	CS=G2(I2)
	CALL PRTCHR (P,CS)
15340	CONTINUE
	IF (OK .EQ. 0) GOTO 15390
	IF (OK .EQ. 2) GOTO 15375
C	 UP GUESS IN ROW
	R2=R2+1
15375	GOTO 15600
C
C	  BURN FUSE
15390	F2=F2+1
	R2=0
	LEFT=0
	CALL BURNFS(LEFT)
C
C	 SEE IF (HES HAD TEN GUESSES
	IF (F2 .LT. 8) GOTO 16000
C
C	  THE BANG
C
C	 BLOW US UP
	CALL BLOTWO(0)
	P2=1
	GOTO 15700
C	 SEE IF (HES GOT ALL THE LETTERS
15600	DO 15630 I=1,L2
	    IF (G2(I) .EQ. 45) GOTO 16000
15630	CONTINUE
C
C	 HE GOT THE WORD
15660	T2=T2+S2
	IF (FP .EQ. 0) GOTO 15700
	FP=0
C	 AWARD FUSE POINTS
	T2=T2+(8-F2)*2
C	 FINISHED
15700	C2=1
	S2=0
	P=82
	CALL PRTNUM(90,T2,3)
C	 YOU BLEW UP
	IF (P2 .EQ. 1) GOTO 16000
C	 HE BLEW UP ALREADY pseudo return goto 13700
	IF (P1 .EQ. 1) GOTO 13700
C	  BLOW UP 1
15780	CALL BLOONE(0)
C	 pseudo return goto 13700
	GOTO 13700
C
C		  SEE IF GAME OVER
C
16000	IF (C1 .EQ. 0) GOTO 14000
	IF (C2 .EQ. 0) GOTO 15000
C	ROUND OVER
	GOTO 13700
C
	END
C
C
C
C	SUBROUTINE TO PRINT NUMBERS
C	    CALL PRTNUM(POSITION,NUMBER,CHARCNT)
C		(from tensub ts3f  p 21)
C	*** WARNING ***  hacked to only work for
C			 2 or 3 digit nos
C
	SUBROUTINE PRTNUM(IAT,INUM,CNT)
C
C
	IMPLICIT INTEGER (A-Z)
C
C
	LOGICAL*1 SPACE,ASCII(7)
C
	DATA SPACE /' '/
C
	NUM=INUM
C
   50	DO 200 J=1,3
	ITEMP=NUM/10
	ITEMP1=4-J
	ASCII(ITEMP1)=NUM-10*ITEMP+48
  200	NUM=ITEMP
C
	IF (INUM .GT. 9) GOTO 300
	ASCII(2)=SPACE
	GOTO 310
  300	IF (INUM .GT. 99) GOTO 400
  310	ASCII(1)=SPACE
C
  400	IF (CNT .NE. 2) GOTO 500
	ASCII(1)=ASCII(2)
	ASCII(2)=ASCII(3)
  500	CALL PRTAT(IAT,ASCII(1),CNT)
C
	RETURN
C
	END
C
C
C
C
C	BLOW UP PLAYER ONE
C
C
	SUBROUTINE BLOONE(DISP)
C
	IMPLICIT INTEGER (A-Z)
C
C
	COMMON	/ALPHA/ W1(20),W2(20),DF(2),RN(2),PY,E1,E2,
     $		F1,F2,L1,L2,WD
C
C
C
	IF (DISP .EQ. 1) GOTO 17050
	LEFT=1
	CALL DOEXP(LEFT)
C	DISPLAY THE WORD
17050	POS=E1
	DO 17100 I=1,L1
	CS=W1(I)
	CALL PRTCHR (POS,CS)
17100	CONTINUE
	  CALL WAITFT(2000)
	  CALL CENLIN
17150	RETURN
C
	END
C
C
C	BLOW UP PLAYER TWO
C
C
	SUBROUTINE BLOTWO(DISP)
C
	IMPLICIT INTEGER (A-Z)
C
C
	COMMON	/ALPHA/ W1(20),W2(20),DF(2),RN(2),PY,E1,E2,
     $		F1,F2,L1,L2,WD
C
C
C
C
C
	IF (DISP .EQ. 1) GOTO 18050
	LEFT=0
	CALL DOEXP(LEFT)
C	DISPLAY HIS WORD
18050	POS=E2
	DO 18100 I=1,L2
	CS=W2(I)
	CALL PRTCHR (POS,CS)
18100	CONTINUE
	CALL WAITFT(2000)
	CALL CENLIN
18150	RETURN
C
C
	END
C
C
C	GENERATE A WORD
C
C
	SUBROUTINE GENWD(W,WL)
C
C
	IMPLICIT INTEGER (A-Z)
C
C	WN= THE NUMBER OF WORDS IN THE
C		DICTIONARY FOR EACH LEVEL
C
C
	DIMENSION W(1)
	DIMENSION T(12)
C
	COMMON	/ALPHA/ W1(20),W2(20),DF(2),RN(2),PY,E1,E2,
     $		F1,F2,L1,L2,WD
C
	DATA WN /50/
C	INIT OW > WN
	DATA OW /99/
C
C	  GENERATE A RANDOM WORD
C	   WL = LENGTH OF WORD
C	   W(X)= THE ASCII VALUES FOR THE WORD
20000	IF (DF(PY) .EQ. 4) GOTO 21000
	I=RN(PY)
20049	IF (I .LE. WN) GOTO 20061
	I=I-WN
	GOTO 20049
20061	IF (OW .EQ. I) I=I+1
	IF (I .GT. WN) I=1
	OW=I
	I=WD*WN + I
C
	CALL GETWD(W,I,WL)
C
	RETURN
C
C	  LET HIM INPUT HIS OWN WORD
C
C	 BLANK THE WORD
21000	CALL PRTAT(658,'	    ',12)
	CALL PRTAT(642,'	    ',12)
C	 ASK FOR WORD
	IF (PY .EQ. 1) CALL PRTAT(738,'ENTER WORD ',11)
	IF (PY .EQ. 2) CALL PRTAT(754,'ENTER WORD ',11)
C	 GET LETTERS
	P=658
	IF (PY .EQ. 1) P=642
	DO 21400 I=1,12
21320	CALL GTCHAR(C)
C	 ' MAKE UPPER CASE
	C=C .AND. 95
	IF (C .LT. 65) GOTO 21330
	IF (C .LT. 91) GOTO 21360
21330	IF (I .EQ. 1) GOTO 21320
	I=12
	GOTO 21400
21360	W(I)=C
	WL=I
21400	CONTINUE
C
	P=754
	IF (PY .EQ. 1) P=738
	CALL PRTAT(P,'VERIFY:     ',12)
C	 'GET ANSWER
	DO 21405 I=1,12
21325	CALL GTCHAR(C)
C	 ' MAKE UPPER CASE
	C=C .AND. 95
	IF (C .LT. 65) GOTO 21335
	IF (C .LT. 91) GOTO 21365
21335	IF (I .EQ. 1) GOTO 21325
	I=12
	GOTO 21405
21365	T(I)=C
	TL=I
21405	CONTINUE
C
	IF(TL.NE.WL) GOTO 21000
	DO 21500 I=1,TL
	IF(W(I).NE.T(I)) GOTO 21000
21500	CONTINUE
C
C	 BLANK THE WORD
	P=658
	IF (PY .EQ. 1) P=642
	CALL PRTAT(P,'		  ',12)
	IF (PY .EQ. 1) CALL BLNK1
	IF (PY .EQ. 2) CALL BLNK2
C
	RETURN
C
C
	END
C
C
C	  DRAWS THE CENTRE LINE DOWN THE SCREEN
C
C
	  SUBROUTINE CENLIN
C
	  DO 33060  J=143,751,32
	  ITEMP=J
	  CALL PRTAT (ITEMP,'&!',2)
33060	  CONTINUE
	  RETURN
C
	  END
C
C
C
C
C
C
C	DRAW THE BOMB ON SCREEN
C
C
	SUBROUTINE DRWBOM
C
C
	IMPLICIT INTEGER (A-Z)
C
C
C
	DIMENSION BOMDAT(93)
C
	DATA BOMDAT /293,153,294,152,295,136,296,137,
     $	     324,154,325,155,326,156,327,156,
     $	     328,138,329,139,
     $	     356,157,357,156,358,156,359,156,
     $	     360,156,361,140,
     $	     388,160,389,156,390,156,391,156,
     $	     392,156,393,165,
     $	     420,158,421,161,422,162,423,163,
     $	     424,164,425,141,
     $	     452,159,453,146,454,156,455,156,
     $	     456,143,457,142,
     $	     485,147,486,148,487,144,488,145,
     $	     262,16,263,17,231,18,199,19,
     $	     200,20,201,21,169,22,170,23,
     $	     999/
C
C
	J=1
32110	AL=BOMDAT(J)
	J=J+1
	IF (AL .EQ. 999) GOTO 32250
C	MOVE DOWN THE SCREEN
	AL=AL+65
C	START OF PAT NAME TABLE
	AH=92
32140	IF (AL .LT. 256) GOTO 32180
	AL=AL-256
	AH=AH+1
	GOTO 32140
32180	X=BOMDAT(J)
	J=J+1
	CALL VIDOUT(AL,AH,X)
	GOTO 32110
32250	CALL	BOMFUS
32540	RETURN
C
	END
C
C
C
C
C
C	SUBROUTINE TO DRAW THE DYNAMITE
C
C
	SUBROUTINE DRWDYN
C
	IMPLICIT INTEGER (A-Z)
C
	DIMENSION  DYNDAT(77)
C
C
	DATA DYNDAT /309,128,310,130,311,132,312,134,
     $	     341,129,342,131,343,133,344,135,
     $	     373,104,374,108,375,112,376,116,
     $	     405,105,406,109,407,113,408,117,
     $	     437,106,438,110,439,114,440,118,
     $	     469,107,470,111,471,115,472,119,
     $	     501,120,502,122,503,124,504,126,
     $	     533,121,534,123,535,125,536,127,
     $	     279,18,247,19,248,20,249,21,
     $	     217,22,218,23,
     $	     999/
C
C
C
	J=1
34110	AL=DYNDAT(J)
	J=J+1
	IF (AL .EQ. 999) GOTO 34250
C	MOVE DOWN THE SCREEN
	AL=AL+33
C	START OF PAT NAME TABLE
	AH=92
34140	IF (AL .LT. 256) GOTO 34180
	AL=AL-256
	AH=AH+1
	GOTO 34140
34180	X=DYNDAT(J)
	J=J+1
	CALL VIDOUT(AL,AH,X)
	GOTO 34110
34250	CALL DYNFUS
34540	RETURN
C
	END
C
C
C	SUBROUTINE BURN FUSE
C
C
	SUBROUTINE BURNFS(LEFT)
C
C
	IMPLICIT INTEGER (A-Z)
C
C
	INTEGER*1 FX(40),FY(40)
C
	COMMON	/ALPHA/ W1(20),W2(20),DF(2),RN(2),PY,E1,E2,
     $		F1,F2,L1,L2,WD
C
C
C
C	  FUSE BURN DATA
	DATA FX /83,82,81,80,
     $	     79,78,77,76,
     $	     75,74,73,72,
     $	     72,71,70,69,
     $	     68,67,66,65,
     $	     65,64,63,62,
     $	     61,61,60,60,
     $	     59,59,58,58,
     $	     57,57,56,56,
     $	     56,56,56,56/
	DATA FY /53,53,53,53,
     $	     54,54,54,54,
     $	     55,55,55,55,
     $	     56,56,56,56,
     $	     57,58,58,59,
     $	     60,61,61,62,
     $	     63,64,65,66,
     $	     67,68,69,70,
     $	     71,72,73,74,
     $	     75,76,78,79/
C
C
C
	IF (LEFT .EQ. 0) GOTO 36100
C
C	BURN BOMB FUSE
C	THE FUSE IS IN 40 PARTS AND CAN BE SPLIT UP TO
C	10 BURNS OF 4,8 OF 5,5 OF 8 OR 4 OF 10.
C	IF IT IS CHANGED THE SCORE AT ~15700 NEEDS
C	TO BE CHANGED
	OF=0
	J1=(F1-1)*5+1
	AO=0
	GOTO 36500
C
C	  BURN DYNAMITE FUSE
36100	OF=128
	J1=(F2-1)*5+1
	AO=4
36500	CONTINUE
C
	  CALL SNDHIS
C	TURN OFF RED FUSE PUT ON WHITE
	JTEMP=J1+4
	DO 36570 J2=J1,JTEMP
	ITEMP=AO
	KTEMP=FY(J2)
	CALL VIDOUT(ITEMP,95,KTEMP)
	ITEMP=AO+1
	KTEMP=FX(J2)+OF
	CALL VIDOUT(ITEMP,95,KTEMP)
	ITEMP=AO+2
	CALL VIDOUT(ITEMP,95,4)
	ITEMP=AO+3
	CALL VIDOUT(ITEMP,95,15)
C	CHANGE SPRITES
	AL=2+AO
	DO 36569 X=4,48,4
	CALL VIDOUT(AL,95,X)
	CALL WAITFT(40)
36569	CONTINUE
36570	CONTINUE
C	PUT BACK RED FUSE
	ITEMP=AO+2
	CALL VIDOUT(ITEMP,95,68)
	ITEMP=AO+3
	CALL VIDOUT(ITEMP,95,8)
C	  TURN OFF HISS
	CALL SNDNDH
36620	RETURN
C
C
	END
C
C
C	DO THE EXPLOSION
C
C
	SUBROUTINE DOEXP(LEFT)
C
	IMPLICIT INTEGER (A-Z)
C
C
	LOGICAL*1 ZERODT(16),COLARY(10)
	LOGICAL*1 LPCDAT(10),EXPDAT(320)
	DIMENSION C(32)
C
C
	DATA ZERODT/0,0,0,0,0,0,0,0,
     $	     0,0,0,0,0,0,0,0/
C
	DATA LPCDAT /203,169,132,68,68,
     $	     68,68,68,68,68/


C
	DATA EXPDAT /249,
     $		  249, 249, 249, 249, 249, 249, 249,
     $	     249, 249, 249, 249, 249, 249, 249, 249,
     $	     241, 241, 241, 241, 241, 241, 241, 241,
     $	     241, 241, 241, 241, 241, 241, 241, 241,
     $	     232, 233, 233, 233, 233, 233, 233, 233,
     $	     233, 233, 233, 233, 233, 233, 233, 234,
     $	     239, 224, 225, 225, 225, 225, 225, 225,
     $	     225, 225, 225, 225, 225, 225, 226, 235,
     $	     239, 231, 216, 217, 217, 217, 217, 217,
     $	     217, 217, 217, 217, 217, 218, 227, 235,
     $	     239, 231, 223, 208, 209, 209, 209, 209,
     $	     209, 209, 209, 209, 210, 219, 227, 235,
     $	     239, 231, 223, 215, 200, 201, 201, 201,
     $	     201, 201, 201, 202, 211, 219, 227, 235,
     $	     239, 231, 223, 215, 207, 192, 193, 193,
     $	     193, 193, 194, 203, 211, 219, 227, 235,
     $	     239, 231, 223, 215, 207, 199, 184, 185,
     $	     185, 186, 195, 203, 211, 219, 227, 235,
     $	     239, 231, 223, 215, 207, 199, 191, 176,
     $	     178, 187, 195, 203, 211, 219, 227, 235,
     $	     239, 231, 223, 215, 207, 199, 191, 182,
     $	     180, 187, 195, 203, 211, 219, 227, 235,
     $	     239, 231, 223, 215, 207, 199, 190, 189,
     $	     189, 188, 195, 203, 211, 219, 227, 235,
     $	     239, 231, 223, 215, 207, 198, 197, 197,
     $	     197, 197, 196, 203, 211, 219, 227, 235,
     $	     239, 231, 223, 215, 206, 205, 205, 205,
     $	     205, 205, 205, 204, 211, 219, 227, 235,
     $	     239, 231, 223, 214, 213, 213, 213, 213,
     $	     213, 213, 213, 213, 212, 219, 227, 235,
     $	     239, 231, 222, 221, 221, 221, 221, 221,
     $	     221, 221, 221, 221, 221, 220, 227, 235,
     $	     239, 230, 229, 229, 229, 229, 229, 229,
     $	     229, 229, 229, 229, 229, 229, 228, 235,
     $	     238, 237, 237, 237, 237, 237, 237, 237,
     $	     237, 237, 237, 237, 237, 237, 237, 236,
     $	     245, 245, 245, 245, 245, 245, 245, 245,
     $	     245, 245, 245, 245, 245, 245, 245, 245,
     $	     253, 253, 253, 253, 253, 253, 253, 253,
     $	     253, 253, 253, 253, 253, 253, 253, 253/
C
C
C	 LOAD PATTERN COLOR TABLE
C
	CALL MKADDR(ADDR,22,96)
	CALL JRAMWR(ADDR,LPCDAT,10)
C
C
C
C	LOAD COLOR MATRIX WITH BLUE
C
	DO 57150 I= 1,20
	C(I)=4
57150	CONTINUE
	C(1)=12
	C(2)=11
	C(3)=10
	C(4)=9
	C(5)=8
C
C
C	LOAD THE PATTERN NAME TABLE FOR THE EXPLOSION
C
C
	IF (LEFT .EQ. 1) CALL BOMOFF
	IF (LEFT .EQ. 0) CALL DYNOFF
	PNT=1
	ALSV=96
	DO 51240 I=1,20
	ALSV=ALSV+32
	AL=ALSV
	IF (LEFT .EQ. 0) AL=AL+16
	AH=92
51150	IF (AL .LT. 256) GOTO 51190
	AL=AL-256
	AH=AH+1
	GOTO 51150
51190	CALL MKADDR(ADDR,AL,AH)
	CALL JRAMWR (ADDR,EXPDAT(PNT),16)
	PNT=PNT+16
51240	CONTINUE
C
C	DO THE COLOR CHANGES FOR THE EXPLOSION
C
	SP=1000
	DR=5
	IC=7
	SN=150
	CALL SNDEXP
C	NUMBER OF COLOR CHANGES
	DO 57460 CC=1,DR
C	ONE COLOR CYCLE
	DO 57450 CN=2,14
C
C	PUT NEW COLOR INTO TABLE
C
	DO 57580 I=1,31
	ITEMP=34-I
	ITEMP1=ITEMP-2
	C(ITEMP)=C(ITEMP1)
57580	CONTINUE
C
	C(2)=C(1)
	C(1)=CN
C
	DO 57640 J=1,20,2
	ITEMP=(J+1)/2
	COLARY(ITEMP)=C(J)*16+C(J+1)
57640	CONTINUE
C
	CALL MKADDR(ADDR,22,96)
	CALL JRAMWR(ADDR,COLARY,10)
C
C	THE WAIT LOOP IS TOO COARSE FOR THE LOG
C	INCREMENT OF IC SO A DO LOOP IS USED
C	CALL WAITFT(SP)
	DO 57440 WAIT=1,SP
57440	CONTINUE
	SP=SP+IC
57450	CONTINUE
	IC=IC+IC
57460	CONTINUE
C	FILL SCREEN WITH BLUE
	DO 57480  CC=1,11
	CN=4
C
C	PUT NEW COLOR INTO TABLE
C
	DO 57581 I=1,31
	ITEMP=34-I
	ITEMP1=32-I
	C(ITEMP)=C(ITEMP1)
57581	CONTINUE
C
	C(2)=C(1)
	C(1)=CN
C
	DO 57641 J=1,20,2
	ITEMP=(J+1)/2
	COLARY(ITEMP)=C(J)*16+C(J+1)
57641	CONTINUE
C
	CONTINUE
C
	CALL MKADDR(ADDR,22,96)
	CALL JRAMWR(ADDR,COLARY,10)
C
C	THE WAIT LOOP IS TOO COARSE FOR THE LOG
C	INCREMENT OF IC SO A DO LOOP IS USED
C	CALL WAITFT(SP)
	DO 57470 WAIT=1,SP
C
57470	CONTINUE
57480	CONTINUE
C
C	  RESTORE THE SCREEN TO BLUE
	DO 50775 I=128,736,32
	AL=I
	IF (LEFT .EQ. 0) AL=AL+16
	AH=92
50730	IF (AL .LT. 256) GOTO 50750
	AL=AL-256
	AH=AH+1
	GOTO 50730
50750	CALL MKADDR(ADDR,AL,AH)
	CALL JRAMWR(ADDR,ZERODT,16)
50775	CONTINUE
C
	RETURN
C
C
	END
